---
import BaseLayout from '@/components/layout/BaseLayout.astro';
import Navbar from '@/components/shared/Navbar';
import Hero from '@/components/landing/Hero.astro';
import About from '@/components/landing/About.astro';
import Skills from '@/components/landing/Skills.astro';
import Qualification from '@/components/landing/Qualification.astro';
import Projects from '@/components/landing/Projects.astro';
import Contact from '@/components/landing/Contact.astro';

import { ui, defaultLang } from '@/i18n/ui';

export function getStaticPaths() {
  return [
    { params: { lang: 'es' } },
    { params: { lang: 'en' } },
  ];
}

const { lang } = Astro.params;

// Helper de traducción
const t = (key: string) => {
    // @ts-ignore
    return ui[lang]?.[key] || ui[defaultLang][key];
}

// ✅ PREPARAMOS LOS DATOS PARA EL NAVBAR AQUÍ (SERVER-SIDE)
// Esto crea un objeto simple que sí puede viajar al navegador.
const navLabels = {
    home: t('nav.home'),
    about: t('nav.about'),
    skills: t('nav.skills'),
    experience: t('nav.experience'),
    projects: t('nav.projects'),
};
---

<BaseLayout title="Juanpe | Full Stack Portfolio" lang={lang}>
  
  <!-- Pasamos navLabels en lugar de t -->
  <Navbar client:load lang={lang} labels={navLabels} />
  
  <main>
    <!-- Los componentes .astro SÍ pueden recibir la función t porque corren en el servidor -->
    <Hero t={t} lang={lang} />
    <About t={t} />
    <Skills t={t} />
    <Qualification t={t} />
    <Projects t={t} />
    <Contact t={t} />
  </main>
  
  <footer class="py-8 text-center text-sm text-slate-500 dark:text-slate-600">
    © 2025 Juanpe Portfolio. Built with Astro & React.
  </footer>

</BaseLayout>