---
// src/pages/[lang]/index.astro
// Este archivo maneja las rutas:
// - https://juanpe-gomez.vercel.app/es (Español)
// - https://juanpe-gomez.vercel.app/en (Inglés)

import BaseLayout from '@/components/layout/BaseLayout.astro';
import Navbar from '@/components/shared/Navbar';
import Hero from '@/components/landing/Hero.astro';
import About from '@/components/landing/About.astro';
import Skills from '@/components/landing/Skills.astro';
import Qualification from '@/components/landing/Qualification.astro';
import Projects from '@/components/landing/Projects.astro';
import Contact from '@/components/landing/Contact.astro';
import Footer from '@/components/shared/Footer.astro';

import { ui, defaultLang } from '@/i18n/ui';

// Definir las rutas estáticas que Astro debe generar
// Esto crea dos páginas: /es y /en
export function getStaticPaths() {
  return [
    { params: { lang: 'es' } },
    { params: { lang: 'en' } },
  ];
}

// Obtener el idioma desde los parámetros de la URL
// Si la URL es /es, lang será 'es'
// Si la URL es /en, lang será 'en'
const { lang } = Astro.params;

// Función helper para obtener traducciones
// Busca primero en el idioma actual, si no existe usa el idioma por defecto
const t = (key: string) => {
    // @ts-ignore
    return ui[lang]?.[key] || ui[defaultLang][key];
}

// Preparar las etiquetas del Navbar en el idioma correcto
// Esto se hace en el servidor para que React reciba los datos ya traducidos
const navLabels = {
    home: t('nav.home'),
    about: t('nav.about'),
    skills: t('nav.skills'),
    experience: t('nav.experience'),
    projects: t('nav.projects'),
};
---

<BaseLayout title="Juanpe | Full Stack Portfolio" lang={lang}>
  

  <Navbar client:load lang={lang} labels={navLabels} />
  
  <main>

    <Hero t={t} lang={lang} />
    <About t={t} lang={lang} />
    <Skills t={t} />
    <Qualification t={t} lang={lang} />
    <Projects t={t} lang={lang} />
    <Contact t={t} />
  </main>
  
  <Footer t={t} lang={lang} />

</BaseLayout>